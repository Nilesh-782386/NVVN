<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NGO-login</title>
    <link rel="stylesheet" href="css/login_register/ngo_login.css">
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="icon" href="img/logo.svg" type="image/x-icons" />
    
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
  />
 
</head>

<body>
    

  <%-include("../partials/navbar.ejs", { user: user, ngo: ngo }) %>

    <div class="parent">
      <div class="maindiv">
        <form action="/ngo-login" method="post" id="loginForm" >
          <h2 class="head">Sign In for NGO</h2>
          <div class="namediv">
            <div class="fname">
                <label for="email">Email</label><br>
                <!-- ✅ FIXED: id="email" -->
                <input type="email" id="email" name="email" placeholder="Enter your mail" autofocus >
            </div>
            <div class="lname">
                <label for="password">Password</label><br>
                <!-- ✅ FIXED: id="password" -->
                <input type="password" id="password" placeholder="Enter your password" name="password">
                <!-- ADD AFTER PASSWORD FIELD -->
                <small style="color: #666; font-size: 12px; display: block; margin-top: 5px;">
                    Use your NGO Registration Number as password
                </small>
            </div>
            <button type="submit" value="submit" class="but">Sign In</button>
          </form>
            <div class="cent">
              <p class="nomargin">or sign up with</p>
              <div class="icons">
                <i class="fa-brands fa-google footfa-brands"></i>
                <i class="fa-brands fa-square-facebook footfa-brands"></i>
              </div>
            
              <p class="already">Don't have a account sign Up ? <a href="/ngo-register" class="login">Sign UP</a></p>
            
            </div>
            </div>
        </div>
       
      </div>
    </div>
      
</body>

<script>
document.getElementById("loginForm").addEventListener("submit", function(event) {
  event.preventDefault();

  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;

  console.log("Submitting NGO login:", { email, password });

  fetch("/ngo-login", {
    method: "POST",
    headers: {
      "content-type": "application/json",
    },
    body: JSON.stringify({ email: email, password: password }),
  })
    .then(response => {
      console.log("Response status:", response.status);
      return response.json();
    })
    .then(data => {
      console.log("Response data:", data);
      
      if (data.success) {
        alert("Login successful! Redirecting...");
        window.location.href = data.redirect || "/ngo-dashboard";
      } else {
        alert(data.message || "Login failed. Please try again.");
      }
    })
    .catch(error => {
      console.error("There was a problem with the fetch operation:", error);
      alert("Network error. Please try again.");
    });
});
</script>

</html>